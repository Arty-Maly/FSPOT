<!DOCTYPE html>
<html>
    <head>
        <title>snap photo</title>
            <%= stylesheet_link_tag "upload", media: "all" %>
            <link rel = "stylesheet" href = "http://code.jquery.com/mobile/1.3.2/jquery.mobile-1.3.2.min.css">
            <script src = "http://code.jquery.com/jquery-1.8.3.min.js"></script>
            <script src = "http://code.jquery.com/mobile/1.3.2/jquery.mobile-1.3.2.min.js"></script>
    </head>

<body>
<div>
	<p><%= link_to "Back To Main Page", main_path %> 
	<br>
	<br></p>
	<p><%= link_to "Log Out", log_out_path %> </p>
</div>

        <div id = "upload" data-role = "page">

            <div id = "header" data-role = "header">
                <h1>WELCOME TO FSTOP</h1>
            </div>


            <div data-role = "content">

                <div class="ui-grid-a">

                    <div class="ui-block-a">
                        <a href="#" data-role="button" data-corners="true" data-icon="home">main_page</a><br> 
                    </div>
                    
                    <div class="ui-block-b">
                        <a href="#" data-role="button" data-corners="true" data-icon="search">search</a><br>
                    </div>
                    
                </div> 
                
                <input type="file" accept="image/*" capture="camera">
                <canvas id = "canvas"></canvas><br>

                <a href="#" data-role="button" id="snap" onclick="snapshot()">Snap Photo</a>

                <script>

                    var video = document.querySelector("#video");
                    var canvas = document.querySelector('#canvas');
                    var ctx = canvas.getContext('2d');
                    var localMediaStream = null;

                    var errorCallback = function (e) {
                        console.log('Camera did not work.', e);
                    };

                    function snapshot() {
                        if (localMediaStream) {
                            ctx.drawImage(video, 0, 0);
                        }
                    }

                    navigator.getUserMedia = navigator.getUserMedia || navigator.webkitGetUserMedia || navigator.mozGetUserMedia || navigator.msGetUserMedia;

                    window.URL = window.URL || window.webkitURL;

                    navigator.getUserMedia(
                        //constraints
                        {video: true, audio: true}, 

                        //successCallback
                        function (stream) {
                            video.src = window.URL.createObjectURL(stream);
                            localMediaStream = stream;
                        }, 

                        //errorCallback
                        errorCallback);

                </script>           

            </div>



        </div>

    </body>

